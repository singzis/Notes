# EventLoop 事件循环

在JavaScript中，事件循环是一种机制，用于管理和执行异步代码。它确保了代码以非阻塞的方式运行，并处理事件、回调函数和其他异步操作。

事件循环的基本原理是，JavaScript引擎在执行同步代码时，会将异步代码（例如回调函数、定时器等）放入任务队列（Task Queue）中。一旦主线程空闲，事件循环就会将队列中的任务取出并执行。

事件循环由以下几个主要组成部分组成：

1. 调用栈（Call Stack）：用于管理执行上下文的栈结构。同步代码按顺序在调用栈中执行。
2. 任务队列（Task Queue）：用于存储待执行的异步任务。任务队列分为不同的类型，例如宏任务（macrotask）和微任务（microtask）。
3. 事件触发线程：负责监听事件，当事件发生时将回调函数添加到任务队列中。
4. 事件循环线程：负责不断地将任务队列中的任务取出并执行。

事件循环的基本流程如下：

1. 执行全局同步代码，将相关函数添加到调用栈中执行。
2. 遇到异步代码，将其移出主线程，放入任务队列中等待执行。
3. 当调用栈为空时，事件循环会检查任务队列。
4. 如果任务队列中有待执行的微任务，事件循环会优先执行微任务，直到微任务队列为空。
5. 如果微任务队列为空，事件循环会从宏任务队列中取出一个任务，放入调用栈中执行。
6. 执行完当前宏任务后，再次检查微任务队列，执行所有微任务。
7. 重复步骤5和步骤6，直到任务队列和微任务队列都为空。

这个过程会不断循环，以确保异步代码得到及时执行，并保持应用程序的响应性。
